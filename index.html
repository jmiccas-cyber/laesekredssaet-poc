<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Læsekredssæt • POC (schema 1.3)</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    :root { --bg:#0b0f14; --card:#121822; --muted:#b9c2cf; --text:#e6edf3; --ok:#1a7f37; --warn:#b54708; --err:#d1242f; --btn:#2563eb; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:var(--bg); color:var(--text); }
    header { display:flex; gap:16px; align-items:center; padding:16px 20px; background:#0e1520; border-bottom:1px solid #1f2a3a; position:sticky; top:0; z-index:10; }
    header h1 { font-size:18px; margin:0; font-weight:600; letter-spacing:.2px; }
    .env { margin-left:auto; font-size:12px; color:var(--muted); }
    main { padding:20px; display:grid; gap:16px; max-width:1100px; margin:0 auto; }
    .card { background:var(--card); border:1px solid #1f2a3a; border-radius:14px; padding:16px; }
    .row { display:flex; gap:12px; flex-wrap:wrap; align-items:end; }
    label { display:block; font-size:12px; color:var(--muted); margin-bottom:6px; }
    input, select, button, textarea {
      background:#0e1520; color:var(--text); border:1px solid #233044; border-radius:10px; padding:10px 12px; font-size:14px;
    }
    button.primary { background:var(--btn); border-color:#214fb6; cursor:pointer; }
    button.ghost { background:transparent; cursor:pointer; }
    button:disabled { opacity:.6; cursor:not-allowed; }
    .split { display:grid; grid-template-columns: 1fr 340px; gap:16px; }
    @media (max-width: 980px) { .split { grid-template-columns: 1fr; } }
    .badge { display:inline-block; border-radius:999px; padding:4px 10px; font-size:12px; border:1px solid #28415f; color:#c9d6e5; }
    .ok { background:rgba(26,127,55,.16); border-color:#1a7f37; color:#b2f1c8; }
    .warn { background:rgba(181,71,8,.16); border-color:#b54708; color:#ffd7a1; }
    .err { background:rgba(209,36,47,.16); border-color:#d1242f; color:#ffb3b9; }
    .list { display:grid; gap:12px; }
    .item { border:1px solid #223147; border-radius:12px; padding:12px; background:#101826; }
    .item h3 { margin:0 0 6px; font-size:16px; }
    .muted { color:var(--muted); }
    .right { margin-left:auto; }
    .sep { height:1px; background:#1f2a3a; margin:10px 0; }
    .note { font-size:12px; color:var(--muted); }
    .mode { display:flex; gap:8px; align-items:center; }
    .pill { border:1px solid #2a3a54; border-radius:999px; padding:4px; display:flex; gap:4px; background:#0f1724; }
    .pill button { border-radius:999px; padding:6px 10px; border:none; background:transparent; color:#9fb0c7; }
    .pill button.active { background:#1c2740; color:#e6edf3; }
    .error { white-space:pre-wrap; color:#ffb3b9; font-size:12px; }
    .success { color:#b2f1c8; font-size:12px; }
  </style>
</head>
<body>
  <header>
    <h1>Læsekredssæt – POC (schema 1.3)</h1>
    <div class="mode">
      <span class="note">Visning:</span>
      <div class="pill">
        <button id="modeBooker" class="active" type="button">Booker</button>
        <button id="modeAdmin" type="button">Admin</button>
      </div>
    </div>
    <div class="env" id="envInfo">Supabase: not set</div>
  </header>

  <main>
    <!-- Booker -->
    <section class="card" id="bookerCard">
      <div class="row">
        <div style="flex:1 1 220px;">
          <label for="bibliotekSelect">Dit bibliotek</label>
          <select id="bibliotekSelect"></select>
        </div>
        <div style="flex:1 1 240px;">
          <label for="q">Søg (titel/forfatter/ISBN/FAUST)</label>
          <input id="q" type="search" placeholder="fx 'Hildebrandt' eller '978870'">
        </div>
        <div>
          <label for="startDato">Startdato</label>
          <input id="startDato" type="date">
        </div>
        <div>
          <label for="slutDato">Slutdato</label>
          <input id="slutDato" type="date">
        </div>
        <div>
          <button id="btnSearch" class="primary" type="button">Søg sæt</button>
        </div>
      </div>
      <div class="sep"></div>
      <div class="list" id="saetList"></div>
      <div id="bookerMsg" class="note"></div>
    </section>

    <!-- Admin -->
    <section class="card" id="adminCard" style="display:none;">
      <div class="row">
        <div style="flex:1 1 220px;">
          <label for="adminCentralSelect">Admin: Centralbibliotek</label>
          <select id="adminCentralSelect"></select>
        </div>
        <div>
          <button id="btnLoadPending" type="button" class="primary">Indlæs afventende bookinger</button>
        </div>
      </div>
      <div class="sep"></div>
      <div class="list" id="pendingList"></div>
      <div id="adminMsg" class="note"></div>
    </section>

    <!-- Debug / fejl -->
    <section class="card">
      <div id="status" class="note">Klar.</div>
      <div id="error" class="error"></div>
    </section>
  </main>

  <script>
    // >>> UDFYLD DISSE VÆRDIER <<<
    const SUPABASE_URL = "https://qlkrzinyqirnigcwadki.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFsa3J6aW55cWlybmlnY3dhZGtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3NjY2NjgsImV4cCI6MjA3ODM0MjY2OH0.-SV3dn7reKHeYis40I-aF3av0_XmCP-ZqB9KR6JT2so";
    // ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

    window.__APP = {
      supabase: null,
      mode: 'booker',
      currentBibliotekId: null,
      currentCentralId: null
    };

    document.getElementById('envInfo').textContent =
      (SUPABASE_URL && SUPABASE_URL.startsWith('https')) ? 'Supabase: OK' : 'Supabase: not set';

  </script>
  <script src="./script.js"></script>
</body>
</html>
